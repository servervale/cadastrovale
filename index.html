<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cadastro de Clientes Walter Vale</title>
    <style>
      body {
        font-family: 'Segoe UI', sans-serif;
        background: #f4f9f4;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 30px;
      }
      header {
        display: flex;
        align-items: center;
        gap: 20px;
        margin-bottom: 30px;
      }
      header img {
        height: 60px;
      }
      header h1 {
        color: #388e3c;
        font-size: 28px;
        margin: 0;
      }
      .form-container {
        background: #fff;
        padding: 20px 30px;
        border-radius: 12px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        max-width: 600px;
        width: 100%;
      }
      h2 {
        color: #388e3c;
        margin-bottom: 20px;
      }
      .form-step {
        display: none;
      }
      .form-step.active {
        display: block;
      }
      label {
        margin-top: 10px;
        display: block;
        font-weight: bold;
      }
      label span {
        color: red;
      }
      input, select, textarea {
        width: 100%;
        padding: 10px;
        margin-top: 5px;
        border: 1px solid #ccc;
        border-radius: 6px;
        font-size: 16px;
      }
      input.invalid, select.invalid, textarea.invalid {
        border-color: red;
      }
      .buttons {
        margin-top: 20px;
        display: flex;
        justify-content: flex-end;
      }
      button {
        padding: 10px 20px;
        background: #4CAF50;
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
      }
      button:hover {
        background: #45a049;
      }
      .error {
        color: red;
        font-size: 14px;
        margin-top: 10px;
      }
	  .buttons button:first-child {
  margin-right: 20px; /* Ajuste o valor conforme necessário */
}

    </style>
  </head>
  <body>
    <header>
      <img src="https://racoesvale.com.br/wp-content/uploads/elementor/thumbs/logo-footer-qadq6kk4ypf3q0o1wx6vxv171h6r3op298gn242tqe.png" alt="Logo Walter Vale" />
      <h1>Cadastro de Clientes Walter Vale</h1>
    </header>
    <div class="form-container">
      <form id="multiForm">
        <!-- Etapa 1: Dados do Cliente -->
        <div class="form-step active">
          <h2>Dados do Cliente</h2>

          <label>Vendedor <span>*</span></label>
          <select name="vendedor" required>
            <option value="">Selecione</option>
            <option>ALISSON</option>
            <option>CLEIDE FRANCO</option>
            <option>FABIO PEREIRA</option>
            <option>GERSON</option>
            <option>GUILHERME</option>
            <option>GUSTAVO LESSE</option>
            <option>JULIAN PADOVAN</option>
            <option>NADIA</option>
            <option>PEDRO PAULO</option>
            <option>RAUL</option>
            <option>REGINALDO DE ALMEIDA</option>
            <option>RUDSON</option>
            <option>TAMIRES</option>
            <option>WALTER VALE</option>
            <option>CONTAS A PAGAR</option>
          </select>

          <label>Vendedor Compartilhado</label>
          <input type="text" name="vendedor_compartilhado" />

          <label>CPF/CNPJ <span>*</span></label>
          <input type="text" name="cpf_cnpj" id="cpfCnpj" required oninput="mascaraCpfCnpj(this)" />
          <div id="cpfCnpjErro" class="error"></div>

          <label>Nome/Razão Social <span>*</span></label>
          <input type="text" name="nome_razao" id="nomeRazao" required />

          <label>RG / Inscrição Estadual <span>*</span></label>
          <input type="text" name="rg_ie" oninput="mascaraRgIe(this)" required />
        </div>

        <!-- Etapa 2: Contato -->
        <div class="form-step">
          <h2>Contato</h2>

          <label>Telefone (obrigatório) <span>*</span></label>
          <input type="text" name="telefone1" required oninput="mascaraTelefone(this)" />

          <label>Telefone (opcional)</label>
          <input type="text" name="telefone2" oninput="mascaraTelefone(this)" />

          <label>Email <span>*</span></label>
          <input type="email" name="email" required />
        </div>

        <!-- Etapa 3: Endereço de Entrega -->
        <div class="form-step">
          <h2>Endereço de Entrega</h2>

          <label>CEP <span>*</span></label>
          <input type="text" name="cep_entrega" required oninput="mascaraCep(this)" />

          <label>Endereço <span>*</span></label>
          <input type="text" name="endereco_entrega" required />

          <label>Número <span>*</span></label>
          <input type="text" name="numero_entrega" required />

          <label>Bairro <span>*</span></label>
          <input type="text" name="bairro_entrega" required />

          <label>Cidade <span>*</span></label>
          <input type="text" name="cidade_entrega" required />

          <label>Link de Localização (opcional)</label>
          <input type="url" name="link_entrega" />

          <label>Usar o mesmo endereço para cobrança?</label>
          <select id="usarMesmoEndereco">
            <option value="sim">Não</option>
            <option value="nao">Sim</option>
          </select>
        </div>

        <!-- Etapa 4: Endereço de Correspondência -->
        <div class="form-step">
          <h2>Endereço de Correspondência</h2>

          <label>CEP</label>
          <input type="text" name="cep_cobranca" oninput="mascaraCep(this)" />

          <label>Endereço</label>
          <input type="text" name="endereco_cobranca" />

          <label>Número</label>
          <input type="text" name="numero_cobranca" />

          <label>Bairro</label>
          <input type="text" name="bairro_cobranca" />

          <label>Cidade</label>
          <input type="text" name="cidade_cobranca" />
        </div>

        <!-- Etapa 5: Pagamento -->
        <div class="form-step">
          <h2>Pagamento</h2>

          <label>Prazo <span>*</span></label>
          <input type="text" name="prazo" required />

          <label>Faturamento <span>*</span></label>
          <select name="tipo_Fat" required>
            <option value="">Selecione</option>
            <option value="Recibo">Recibo</option>
            <option value="Nota Fiscal">Nota Fiscal</option>
          </select>

          <label>Informações Adicionais</label>
          <textarea name="info_adicional"></textarea>
        </div>

        <!-- Etapa 6: Resumo -->
        <div class="form-step">
          <h2>Resumo</h2>
          <p>Revise os dados antes de enviar.</p>
        </div>

        <div class="buttons">
          <button type="button" onclick="prevStep()">Voltar</button>
          <button type="button" onclick="nextStep()">Próximo</button>
          <button type="submit" style="display: none;">Enviar</button>
        </div>
      </form>
    </div>
    <script>
      const steps = document.querySelectorAll('.form-step');
      const nextBtn = document.querySelector("button[onclick='nextStep()']");
      const prevBtn = document.querySelector("button[onclick='prevStep()']");
      const submitBtn = document.querySelector("button[type='submit']");
      let currentStep = 0;

      function showStep(index) {
        steps.forEach((step, i) => {
          step.classList.toggle('active', i === index);
        });
        prevBtn.style.display = index === 0 ? 'none' : 'inline-block';
        nextBtn.style.display = index === steps.length - 1 ? 'none' : 'inline-block';
        submitBtn.style.display = index === steps.length - 1 ? 'inline-block' : 'none';
      }

      function nextStep() {
        const currentInputs = steps[currentStep].querySelectorAll('input, select, textarea');
        let allValid = true;
        let errorDisplayed = false;

        currentInputs.forEach(input => {
          input.classList.remove('invalid');
          if (input.hasAttribute('required') && !input.value.trim()) {
            input.classList.add('invalid');
            allValid = false;
          }
        });

        if (!allValid) {
          if (!document.querySelector('.error-global')) {
            const msg = document.createElement('div');
            msg.className = 'error error-global';
            msg.textContent = 'Preencha todos os campos obrigatórios.';
            steps[currentStep].appendChild(msg);
          }
          return;
        }

        const oldMsg = document.querySelector('.error-global');
        if (oldMsg) oldMsg.remove();

        // pular endereço de cobrança se marcado como igual
        if (currentStep === 2 && document.getElementById('usarMesmoEndereco').value === 'nao') {
          currentStep++;
        }

        currentStep++;
        showStep(currentStep);
      }

      function prevStep() {
        const oldMsg = document.querySelector('.error-global');
        if (oldMsg) oldMsg.remove();

        currentStep--;
        showStep(currentStep);
      }

      showStep(currentStep);

      document.getElementById('multiForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const dados = new FormData(this);
        fetch('https://script.google.com/macros/s/AKfycbxdpNAo96Pn1bnhex-UCLG8rRHQBnmigbP7yDnJUAP_FSVpzzu-uyNmtrSo3kid92_H_w/exec', {
          method: 'POST',
          body: dados
        })
        .then(response => response.text())
        .then(data => {
          alert('Formulário enviado com sucesso!');
          window.location.reload();
        })
        .catch(error => {
          alert('Erro ao enviar formulário.');
          console.error(error);
        });
      });

      function mascaraCpfCnpj(campo) {
        const valor = campo.value.replace(/\D/g, '');
        if (valor.length <= 11) {
          campo.value = valor.replace(/(\d{3})(\d)/, '$1.$2')
                             .replace(/(\d{3})(\d)/, '$1.$2')
                             .replace(/(\d{3})(\d{1,2})$/, '$1-$2');
        } else {
          campo.value = valor.replace(/(\d{2})(\d)/, '$1.$2')
                             .replace(/(\d{3})(\d)/, '$1.$2')
                             .replace(/(\d{3})(\d{4})(\d)/, '$1/$2-$3');
        }
        validarCpfCnpj(valor);
      }

      function mascaraTelefone(campo) {
        const valor = campo.value.replace(/\D/g, '');
        campo.value = valor.replace(/(\d{2})(\d{5})(\d{4})/, '($1) $2-$3');
      }

      function mascaraCep(campo) {
        const valor = campo.value.replace(/\D/g, '');
        campo.value = valor.replace(/(\d{5})(\d{3})/, '$1-$2');
      }

      function mascaraRgIe(campo) {
        let valor = campo.value.replace(/\D/g, '');
        if (valor.length <= 9) {
          valor = valor.replace(/(\d{2})(\d{3})(\d{3})(\d{1})/, '$1.$2.$3-$4');
        } else {
          valor = valor.replace(/(\d{3})(\d{3})(\d{3})(\d{3})/, '$1.$2.$3.$4');
        }
        campo.value = valor;
      }

      function validarCpfCnpj(valor) {
        const erroDiv = document.getElementById('cpfCnpjErro');
        const apenasNumeros = valor.replace(/\D/g, '');

        if (apenasNumeros.length < 11 || (apenasNumeros.length > 11 && apenasNumeros.length < 14)) {
          erroDiv.textContent = '';
          return false;
        }

        if (apenasNumeros.length === 11) {
          if (validarCpf(apenasNumeros)) {
            erroDiv.textContent = '';
            return true;
          } else {
            erroDiv.textContent = 'CPF inválido.';
            return false;
          }
        } else if (apenasNumeros.length === 14) {
          if (validarCnpj(apenasNumeros)) {
            erroDiv.textContent = '';
            return true;
          } else {
            erroDiv.textContent = 'CNPJ inválido.';
            return false;
          }
        } else {
          erroDiv.textContent = '';
          return false;
        }
      }

      function validarCpf(cpf) {
        if (/^(\d)\1+$/.test(cpf)) return false;

        let soma = 0;
        for (let i = 0; i < 9; i++) {
          soma += parseInt(cpf.charAt(i)) * (10 - i);
        }
        let dig1 = 11 - (soma % 11);
        if (dig1 >= 10) dig1 = 0;

        soma = 0;
        for (let i = 0; i < 10; i++) {
          soma += parseInt(cpf.charAt(i)) * (11 - i);
        }
        let dig2 = 11 - (soma % 11);
        if (dig2 >= 10) dig2 = 0;

        return dig1 == cpf.charAt(9) && dig2 == cpf.charAt(10);
      }

      function validarCnpj(cnpj) {
        if (/^(\d)\1+$/.test(cnpj)) return false;

        const calcDig = (base, pesos) => {
          let soma = 0;
          for (let i = 0; i < pesos.length; i++) {
            soma += parseInt(base.charAt(i)) * pesos[i];
          }
          let resto = soma % 11;
          return resto < 2 ? 0 : 11 - resto;
        };

        const base = cnpj.slice(0, 12);
        const dig1 = calcDig(base, [5, 4, 3, 2, 9, 8, 7, 6, 5, 4, 3, 2]);
        const dig2 = calcDig(base + dig1, [6, 5, 4, 3, 2, 9, 8, 7, 6, 5, 4, 3, 2]);

        return cnpj === base + dig1 + dig2;
      }
    </script>
  </body>
</html>
